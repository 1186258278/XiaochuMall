System.register(["./index-legacy.6abde332.js"],(function(e){"use strict";var t,n,a,o,l,i,u,d,s,r,p,m,y,g;return{setters:[function(e){t=e._,n=e.E,a=e.r,o=e.c,l=e.d,i=e.w,u=e.F,d=e.o,s=e.f,r=e.j,p=e.a,m=e.t,y=e.e,g=e.b}],execute:function(){const c={name:"couponManage",data:()=>({limit:8,name:"",data:{data:{},count:0},type:1,Token:"",show:!1,CouponData:{}}),watch:{type(e,t){this.getListCoupon(1)},name(){this.getListCoupon(1)}},mounted(){this.getListCoupon()},methods:{Conversion(){if(""===this.Token)return void this.$message({message:"请将券码填写完整！",type:"error",grouping:!0});let e=this;n.confirm("确定要兑换："+this.Token+" 吗？","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{e.$ajax.post("ajax.php?act=CouponConversion",{token:e.Token}).then((t=>{t.code>=0?(n.alert(t.msg,"恭喜",{confirmButtonText:"好的",dangerouslyUseHTMLString:!0}),e.getListCoupon(1)):n.alert(t.msg,"警告",{confirmButtonText:"好的",dangerouslyUseHTMLString:!0})}))}))},renderCountdown(e){let t="";return t=e.hours>24?Math.floor(e.hours/24)+"天"+e.hours%24+"小时":e.hours+"小时",t+e.minutes+"分"+e.seconds+"秒后过期"},getListCoupon(e=1){let t=this;this.$ajax.post("ajax.php?act=CouponList",{page:e,limit:t.limit,name:t.name,type:t.type}).then((function(e){e.code>=0?t.data=e:t.data={data:{},count:0}}))},Router(e,t={}){this.$router.push({path:e,query:t})}}},h={style:{"margin-bottom":"1em"}},f=y("搜索券码"),k=y("券码兑换"),C=y("点击兑换"),x={key:0},_={key:0},b={key:1},v={key:2},w={style:{"margin-top":"1em"}},z=y("通用券"),T=y(" 满减 "),D=y("立减 "),L=y("折扣"),V={key:0,style:{"margin-top":"1em",color:"darkgoldenrod","font-size":"0.8em"}},j={key:1,style:{color:"#e5610d"}},U={key:1,style:{"margin-top":"1em",color:"darkgoldenrod","font-size":"0.8em"}},B={style:{color:"#e5610d"}},M={key:1},$=s("thead",null,[s("tr",null,[s("th",null,"参数"),s("th",null,"内容")])],-1),S=s("td",null,"券码",-1),H=s("td",null,"领取时间",-1),q={key:0},E=s("td",null,"使用时间",-1),F=s("td",null,"相关说明",-1);e("default",t(c,[["render",function(e,t,n,c,R,A){const G=a("el-input"),I=a("el-button"),J=a("n-card"),K=a("n-tab-pane"),N=a("n-tabs"),O=a("n-ellipsis"),P=a("n-countdown"),Q=a("el-col"),W=a("el-row"),X=a("el-empty"),Y=a("el-pagination"),Z=a("n-table"),ee=a("el-dialog");return d(),o(u,null,[l(J,{title:"优惠券操作",style:{"margin-bottom":"0.5em"}},{default:i((()=>[s("div",h,[l(G,{modelValue:R.name,"onUpdate:modelValue":t[0]||(t[0]=e=>R.name=e),placeholder:"请输入优惠券名称,订单号,券码等进行搜索！"},{prepend:i((()=>[f])),_:1},8,["modelValue"]),l(G,{style:{"margin-top":"1em"},modelValue:R.Token,"onUpdate:modelValue":t[1]||(t[1]=e=>R.Token=e),placeholder:"请输入您获得的券码"},{prepend:i((()=>[k])),append:i((()=>[l(I,{onClick:A.Conversion},{default:i((()=>[C])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])])),_:1}),l(J,{title:"我的优惠券列表"},{default:i((()=>[l(N,{"default-value":R.type,value:R.type,"onUpdate:value":t[2]||(t[2]=e=>R.type=e),type:"line"},{default:i((()=>[l(K,{name:1,tab:"未使用优惠券"}),l(K,{name:2,tab:"已使用优惠券"})])),_:1},8,["default-value","value"]),R.data.data.length>=1?(d(),o("div",x,[l(W,{gutter:5},{default:i((()=>[(d(!0),o(u,null,r(R.data.data,(e=>(d(),p(Q,{span:6,style:{"margin-bottom":"0.15em","margin-top":"0.15em"}},{default:i((()=>[l(J,{title:e.name,style:{"text-align":"center","box-shadow":"1px 1px 12px #eee","border-radius":"0.5em"}},{default:i((()=>[l(O,{style:{width:"160px"}},{default:i((()=>[1==e.type?(d(),o("span",_,"满"+m(e.minimum)+"元,优惠"+m(e.money)+"元",1)):2==e.type?(d(),o("span",b,"无门槛,下单立减"+m(e.money)+"元",1)):(d(),o("span",v,"满"+m(e.minimum)+"元,享受"+m(e.money/10)+"折优惠",1))])),_:2},1024),s("div",w,[1==e.apply?(d(),p(I,{key:0,type:"primary",plain:"",size:"small"},{default:i((()=>[y("单品券["+m(e.gid)+"]",1)])),_:2},1024)):2==e.apply?(d(),p(I,{key:1,type:"warning",plain:"",size:"small"},{default:i((()=>[y("品类券["+m(e.cid)+"]",1)])),_:2},1024)):(d(),p(I,{key:2,type:"success",size:"small",plain:""},{default:i((()=>[z])),_:1})),1==e.type?(d(),p(I,{key:3,type:"danger",text:"",bg:"",size:"small",onClick:t=>{R.CouponData=e,R.show=!0}},{default:i((()=>[T])),_:2},1032,["onClick"])):2==e.type?(d(),p(I,{key:4,type:"success",text:"",bg:"",size:"small",onClick:t=>{R.CouponData=e,R.show=!0}},{default:i((()=>[D])),_:2},1032,["onClick"])):(d(),p(I,{key:5,type:"warning",text:"",bg:"",size:"small",onClick:t=>{R.CouponData=e,R.show=!0}},{default:i((()=>[L])),_:2},1032,["onClick"]))]),1==R.type?(d(),o("div",V,[e.expirytime>=1?(d(),p(P,{key:0,duration:1e3*e.expirytime,render:A.renderCountdown,active:!0},null,8,["duration","render"])):(d(),o("span",j,"优惠券已到期"))])):(d(),o("div",U,[s("span",B,"于"+m(e.endtime)+"使用",1)]))])),_:2},1032,["title"])])),_:2},1024)))),256))])),_:1})])):(d(),o("div",M,[l(X,{description:"空空如也"})])),l(Y,{onCurrentChange:A.getListCoupon,"default-page-size":R.limit,"page-size":R.limit,style:{"margin-top":"1em"},background:"","hide-on-single-page":"",small:"",layout:"total, prev, pager, next, jumper",total:R.data.count},null,8,["onCurrentChange","default-page-size","page-size","total"])])),_:1}),l(ee,{modelValue:R.show,"onUpdate:modelValue":t[3]||(t[3]=e=>R.show=e),title:"优惠券领取详情"},{default:i((()=>[l(Z,{striped:""},{default:i((()=>[$,s("tbody",null,[s("tr",null,[S,s("td",null,m(R.CouponData.token),1)]),s("tr",null,[H,s("td",null,m(R.CouponData.gettime),1)]),R.CouponData.endtime?(d(),o("tr",q,[E,s("td",null,m(R.CouponData.endtime),1)])):g("",!0),s("tr",null,[F,s("td",null,m(R.CouponData.content),1)])])])),_:1})])),_:1},8,["modelValue"])],64)}]]))}}}));
